!function(){var e;chrome.runtime&&chrome.runtime.getManifest&&chrome.runtime.getManifest().version,e={settingsFile:"settings.json"};var t=["ru","en","en_US"],n=[{lang:"ru",name:"Русский"},{lang:"en",name:"English"}],a="ru",i=["RUB","USD","EUR"],r=[{curr:"RUB",name:"Рубль"},{curr:"USD",name:"USD"},{curr:"EUR",name:"Euro"}],c="RUB";$.ajaxSetup({timeout:6e4});var o,l=function(e){return e?chrome.i18n.getMessage(e):""};try{"en"===chrome.i18n.getMessage("@@ui_locale").split("_")[0]&&(c="USD")}catch(e){}function u(e){var t={type:"sendGaData"};e.category&&(t.category=e.category),e.action&&(t.action=e.action),e.label&&(t.label=e.label),chrome.runtime.sendMessage(t,function(e){chrome.runtime.lastError&&chrome.runtime.lastError.message})}chrome.storage&&chrome.storage.local.get({uiCurrency:!1},function(e){!1===e.uiCurrency||-1===i.indexOf(e.uiCurrency)?chrome.storage.local.set({uiCurrency:c}):c=e.uiCurrency,$(".select-row--uiCurrency select").html(""),$.each(r,function(e,t){-1!==i.indexOf(t.curr)&&$(".select-row--uiCurrency select").append('<option value="'+t.curr+'" '+(c===t.curr?" selected":"")+">"+t.name+"</option>")})}),function(e){var i=$.Deferred();function r(r,c){a=r;var o=$.Deferred();c||e?$.getJSON(chrome.extension.getURL("_locales/"+r+"/messages.json")).done(function(e){l=function(t){return e[t]&&e[t].message||chrome.i18n.getMessage(t)},o.resolve("initTranslation done")}).fail(function(){o.resolve("initTranslation fail")}):o.resolve("initTranslation correct language"),o.done(function(){$(".translate").each(function(){$(this).html(l($(this).attr("data-localize")))}),$(".translate--placeholder").each(function(){$(this).attr("placeholder",l($(this).attr("data-localize")))}),$(".ali-plugin-wrap").removeClass("loading"),$(".select-row--uiLanguage select").html(""),$.each(n,function(e,n){-1!==t.indexOf(n.lang)&&$(".select-row--uiLanguage select").append('<option value="'+n.lang+'" '+(a==n.lang?" selected":"")+">"+n.name+"</option>")}),i.resolve(r,"initTranslation done")})}return chrome.storage.local.get({uiLanguage:!1},function(e){var n=chrome.i18n.getMessage("@@ui_locale").split("_")[0],i=a;!1!==e.uiLanguage?r(i=e.uiLanguage,n&&i!==n):(i=void 0!==n&&-1!==t.indexOf(n)?n:chrome.runtime&&chrome.runtime.getManifest().default_locale?chrome.runtime.getManifest().default_locale:"ru",chrome.storage.local.set({uiLanguage:i},function(){r(i,n&&i!==n)}))}),i.promise()}().done(function(e){$(document).ready(function(){chrome.storage.local.get({sellerCheck:!0,comments:!0,search:!0,myali:!0,useful:!0,tracking:!0},function(e){!1===e.search&&$(".search--top").addClass("hidden"),!1===e.myali&&$(".user_login").hide(0),!1===e.useful&&$(".plugin-links").hide(0),!1===e.tracking&&$(".search--bot").hide(0)}),$(".main_nav").on("click auxclick",function(t){if("auxclick"===t.type&&2!==t.which)return!0;t.preventDefault(),t.stopPropagation();var n=$(this).attr("href"),a=e&&$(this).attr("data-link-"+e);a&&(n=a),$(this).hasClass("skip_prom")?chrome.tabs.create({url:n}):chrome.runtime.sendMessage({type:"createPromTab",url:n,bg:"auxclick"===t.type})}).on("mousedown",function(){var t=e&&$(this).attr("data-link-"+e);t&&$(this).attr("href",t)}),$("#search_form").submit(function(t){t.preventDefault();var n=$("#search_text").val().trim(),a="https://"+("ru"===e?"ru":"www")+".aliexpress.com/wholesale?SearchText="+encodeURIComponent(n)+"&d=y&origin=n&isViewCP=y&catId=0";n&&chrome.runtime.sendMessage({type:"createPromTab",url:a})}).find("a.submit").on("click",function(e){return $("#search_form").submit(),u({category:"Plugin popup",action:"click",label:"Search form submit"}),!1}),$("#tracking_form").submit(function(t){t.preventDefault();var n=$("#tracking_code").val().trim(),a="https://www.17track.net/"+e+"/track?nums="+n;n&&chrome.tabs.create({url:a})}).find("a.submit").on("click",function(e){return $("#tracking_form").submit(),u({category:"Plugin popup",action:"click",label:"Tracking form submit"}),!1}),$("#howto-link").click(function(t){chrome.runtime.sendMessage({type:"createPromTab",url:"https://"+("ru"===e?"ru":"www")+".aliexpress.com/#helper_howto"}),t.preventDefault()}),$(".ali-plugin-wrap .heading__link").click(function(){u({category:"Plugin popup",action:"click",label:"Settings link in popup click"})}),$(".ali-plugin-wrap .plugin-links__menu__link").click(function(){u({category:"Plugin popup",action:"click",label:"Menu item click - "+$(this).find(".translate").text()})}),$(".ali-plugin-wrap .banners__link").click(function(){return u({category:"Plugin popup",action:"click",label:"Banner in popup click - "+$(this).text()}),!1}),$(".ali-plugin-wrap .ali-support").click(function(){var e=$(this).attr("href");return chrome.tabs.create({url:e},function(e){}),u({category:"Plugin settings",action:"click",label:"Popup support link click"}),!1}),$(".ali-plugin-wrap .heading__logo__link").on("click auxclick",function(e){if("auxclick"===e.type&&2!==e.which)return!0;chrome.runtime.sendMessage({type:"createPromTab",url:$(this).attr("href"),bg:"auxclick"===e.type}),u({category:"Plugin popup",action:"click",label:"Head logo click"}),e.preventDefault()})})}),(o=$.Deferred(),chrome.storage.local.get({settingsJson:!1},function(t){!1!==t.settingsJson?(e.settings=t.settingsJson,o.resolve(t.settingsJson)):$.ajax({url:"https://aliexpress-checker.ru/"+e.settingsFile,type:"GET",data:{},crossDomain:!0,async:!0}).done(function(t){e.settings=t,t&&o.resolve(t)}).fail(function(){o.reject()})}),o.promise()).done(function(e){e&&e.bannerHtml&&$(".ali-plugin-wrap--popup .banners").html(e.bannerHtml)}),u({category:"Plugin popup",action:"show",label:"Popup page"})}();